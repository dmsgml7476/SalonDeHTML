<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link rel="stylesheet" href="mybooklistgrid.css" />
      </head>
      <body>
        <div class="my-page">
          <div class="my-page-container">
            <div class="my-page-wrap">
              <div class="my-page-menus-area">
                <div class="my-page-menus">
                  <div class="my-page-menu">
                    <a class="my-reservation">내 예약 내역</a>
                  </div>

                  <div class="my-page-menu">
                    <a class="my-coupons">쿠폰/정액권</a>
                  </div>

                  <div class="my-page-menu">
                    <a claas="my-like-page">찜목록</a>
                  </div>

                  <div class="my-page-menu">
                    <a class="my-review"> 내 리뷰 </a>
                  </div>

                  <div class="my-page-menu">
                    <a class="my-cs-list-page">나의 고객문의</a>
                  </div>
                </div>
              </div>
            </div>

            <div class="my-page-content-area">
              <div class="my-page-content-box">
                <div class="my-page-title">내 예약 내역</div>

                <div class="my-reservation-list">
                  <!-- 예약중 -->
                  <div class="my-reservation-box">
                    <div class="my-reservation-title">
                      <div class="res-designer">
                        <span class="designer-name">나미리 디자이너</span>
                        <spna class="shop-name">(떡잎마을 미용실)</spna>
                      </div>

                      <div class="reservation-info-box">
                        <div class="reservation-date">2025.05.20</div>
                        <div class="reservation-time">12:30</div>
                        <div class="service-name">커트</div>
                      </div>

                      <div class="reservation-status">예약중</div>
                    </div>
                    <div class="my-reservation-details" style="display: none">
                      <div class="price-details">
                        <div class="service-price">
                          <div class="price-box">
                            <span>시술가격</span>
                            <span>30000</span>
                          </div>
                          <div class="coupon-icon-area"></div>
                        </div>
                        <div class="coupon-discount">
                          <div class="price-box">
                            <span>할인가격</span>
                            <spna>-5000</spna>
                          </div>
                          <div class="coupon-icon-area">
                            <div class="coupon-container">
                              <img
                                src="/image/coupon.png"
                                alt="쿠폰"
                                class="coupon-img"
                              />
                              <div class="tooltip">
                                <div>
                                  <strong>쿠폰이름</strong>
                                  <span class="tooltip-time">만료 3일전</span>
                                </div>
                                <div>
                                  <div>
                                    <strong>15%</strong>
                                  </div>
                                  <div class="tooltip-min">
                                    최소 금액 : 20,000
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="ticket-used-amount">
                          <div class="price-box">
                            <span>사용금액</span>
                            <span>-25000</span>
                          </div>
                          <div class="coupon-icon-area">
                            <div class="coupon-container">
                              <img
                                src="/image/coupon.png"
                                alt="쿠폰"
                                class="coupon-img"
                              />
                              <div class="tooltip">
                                <div>
                                  <strong>000샵 정액권</strong>
                                  <div>100,000</div>
                                </div>
                                <div>
                                  <strong>현재 잔액</strong>
                                  <div>70,000</div>
                                </div>
                                <div>
                                  <strong>결제 예정액</strong>
                                  <div>-25,000</div>
                                </div>

                                <div></div>

                                <div>
                                  <strong>예정 잔액</strong>
                                  <div>45,000</div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="final-price">
                          <div class="price-box">
                            <span>지불 예정액</span>
                            <span>0</span>
                          </div>
                          <div class="coupon-icon-area">
                            <img src="/image/coupon.png" alt="쿠폰" />
                          </div>
                        </div>
                      </div>

                      <div class="shop-info-details">
                        <div class="address-box">
                          <div class="address-title">주소</div>
                          <div class="address">
                            대전 광역시 대덕구 어쩌구저쩌구
                          </div>
                        </div>

                        <div class="tel-box">
                          <div class="tel-title">전화번호</div>
                          <div class="tel">010-5482-5482</div>
                        </div>
                      </div>
                      <div class="btn-box">
                        <button class="reservation-change" href="">
                          변경하기
                        </button>
                        <button class="re-reservation" href="">
                          재예약하기
                        </button>
                        <button
                          class="review-create"
                          onclick="openCreateReviewModal()"
                        >
                          리뷰쓰기
                        </button>
                        <button class="review-show" href="">리뷰 보기</button>
                      </div>
                    </div>
                  </div>
                  <!-- 존재하는 예약만큼 반복 -->
                  <!-- 예약 완료된 경우 -->

                  <div class="my-reservation-box">
                    <div class="my-reservation-title">
                      <div class="res-designer">
                        <span class="designer-name">나미리 디자이너</span>
                        <spna class="shop-name">(떡잎마을 미용실)</spna>
                      </div>

                      <div class="reservation-info-box">
                        <div class="reservation-date">2025.05.20</div>
                        <div class="reservation-time">12:30</div>
                        <div class="service-name">커트</div>
                      </div>

                      <div class="reservation-status">예약완료</div>
                    </div>
                    <div class="my-reservation-details" style="display: none">
                      <!-- 결제 전 -->
                      <div
                        style="
                          display: grid;
                          grid-template-columns: 1fr 1fr;
                          gap: 10px;
                        "
                      >
                        <div class="price-details payment-before">
                          <div class="service-price">
                            <div>예약 가격</div>
                            <div class="price-box price-complete">
                              <span>시술가격</span>
                              <span>30000</span>
                            </div>
                          </div>
                          <div class="coupon-discount">
                            <div class="price-box price-complete">
                              <span>할인가격</span>
                              <spna>-5000</spna>
                            </div>
                          </div>
                          <div class="ticket-used-amount">
                            <div class="price-box price-complete">
                              <span>사용금액</span>
                              <span>-25000</span>
                            </div>
                          </div>
                          <div class="final-price">
                            <div class="price-box price-complete">
                              <span>지불 예정액</span>
                              <span>0</span>
                            </div>
                          </div>
                        </div>

                        <!-- 결제 후 -->

                        <div class="price-details payment-before">
                          <div class="service-price">
                            <div>결제 가격</div>
                            <div class="price-box price-complete">
                              <span>시술가격</span>
                              <span>30000</span>
                            </div>
                          </div>
                          <div class="coupon-discount">
                            <div class="price-box price-complete">
                              <span>할인가격</span>
                              <spna>-5000</spna>
                            </div>
                          </div>
                          <div class="ticket-used-amount">
                            <div class="price-box price-complete">
                              <span>사용금액</span>
                              <span>-25000</span>
                            </div>
                          </div>
                          <div class="final-price">
                            <div class="price-box price-complete">
                              <span>결제액</span>
                              <span>0</span>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="shop-info-details">
                        <div class="address-box">
                          <div class="address-title">주소</div>
                          <div class="address">
                            대전 광역시 대덕구 어쩌구저쩌구
                          </div>
                        </div>

                        <div class="tel-box">
                          <div class="tel-title">전화번호</div>
                          <div class="tel">010-5482-5482</div>
                        </div>
                      </div>

                      <div class="btn-box">
                        <button class="reservation-change" href="">
                          변경하기
                        </button>
                        <button class="re-reservation" href="">
                          재예약하기
                        </button>
                        <button
                          class="review-create"
                          onclick="openCreateReviewModal()"
                        >
                          리뷰쓰기
                        </button>
                        <button class="review-show" href="">리뷰 보기</button>
                      </div>
                    </div>
                  </div>

                  <!-- 예약 취소 -->
                  <div class="my-reservation-box">
                    <div class="my-reservation-title">
                      <div class="res-designer">
                        <span class="designer-name">나미리 디자이너</span>
                        <spna class="shop-name">(떡잎마을 미용실)</spna>
                      </div>

                      <div class="reservation-info-box">
                        <div class="reservation-date">2025.05.20</div>
                        <div class="reservation-time">12:30</div>
                        <div class="service-name">커트</div>
                      </div>

                      <div class="reservation-status">진행중</div>
                    </div>
                    <div class="my-reservation-details" style="display: none">
                      <div class="price-details">
                        <div class="service-price">
                          <div class="price-box">
                            <span>시술가격</span>
                            <span>30000</span>
                          </div>
                          <div class="coupon-icon-area"></div>
                        </div>
                        <div class="coupon-discount">
                          <div class="price-box">
                            <span>할인가격</span>
                            <spna>-5000</spna>
                          </div>
                          <div class="coupon-icon-area">
                            <div class="coupon-container">
                              <img
                                src="/image/coupon.png"
                                alt="쿠폰"
                                class="coupon-img"
                              />
                              <div class="tooltip">
                                <div>
                                  <strong>쿠폰이름</strong>
                                  <span class="tooltip-time">만료 3일전</span>
                                </div>
                                <div>
                                  <div>
                                    <strong>15%</strong>
                                  </div>
                                  <div class="tooltip-min">
                                    최소 금액 : 20,000
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="ticket-used-amount">
                          <div class="price-box">
                            <span>사용금액</span>
                            <span>-25000</span>
                          </div>
                          <div class="coupon-icon-area">
                            <div class="coupon-container">
                              <img
                                src="/image/coupon.png"
                                alt="쿠폰"
                                class="coupon-img"
                              />
                              <div class="tooltip">
                                <div>
                                  <strong>000샵 정액권</strong>
                                  <div>100,000</div>
                                </div>
                                <div>
                                  <strong>현재 잔액</strong>
                                  <div>70,000</div>
                                </div>
                                <div>
                                  <strong>결제 예정액</strong>
                                  <div>-25,000</div>
                                </div>

                                <div></div>

                                <div>
                                  <strong>예정 잔액</strong>
                                  <div>45,000</div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="final-price">
                          <div class="price-box">
                            <span>지불 예정액</span>
                            <span>0</span>
                          </div>
                          <div class="coupon-icon-area">
                            <img src="/image/coupon.png" alt="쿠폰" />
                          </div>
                        </div>
                      </div>

                      <div class="shop-info-details">
                        <div class="address-box">
                          <div class="address-title">주소</div>
                          <div class="address">
                            대전 광역시 대덕구 어쩌구저쩌구
                          </div>
                        </div>

                        <div class="tel-box">
                          <div class="tel-title">전화번호</div>
                          <div class="tel">010-5482-5482</div>
                        </div>
                      </div>
                      <div class="btn-box">
                        <button class="reservation-change" href="">
                          변경하기
                        </button>
                        <button class="re-reservation" href="">
                          재예약하기
                        </button>
                        <button
                          class="review-create"
                          onclick="openCreateReviewModal()"
                        >
                          리뷰쓰기
                        </button>
                        <button class="review-show" href="">리뷰 보기</button>
                      </div>
                    </div>
                  </div>

                  <!-- 노쇼 -->

                  <div class="my-reservation-box">
                    <div class="my-reservation-title">
                      <div class="res-designer">
                        <span class="designer-name">나미리 디자이너</span>
                        <spna class="shop-name">(떡잎마을 미용실)</spna>
                      </div>

                      <div class="reservation-info-box">
                        <div class="reservation-date">2025.05.20</div>
                        <div class="reservation-time">12:30</div>
                        <div class="service-name">커트</div>
                      </div>

                      <div class="reservation-status">진행중</div>
                    </div>
                    <div class="my-reservation-details" style="display: none">
                      <div class="price-details">
                        <div class="service-price">
                          <div class="price-box">
                            <span>시술가격</span>
                            <span>30000</span>
                          </div>
                          <div class="coupon-icon-area"></div>
                        </div>
                        <div class="coupon-discount">
                          <div class="price-box">
                            <span>할인가격</span>
                            <spna>-5000</spna>
                          </div>
                          <div class="coupon-icon-area">
                            <div class="coupon-container">
                              <img
                                src="/image/coupon.png"
                                alt="쿠폰"
                                class="coupon-img"
                              />
                              <div class="tooltip">
                                <div>
                                  <strong>쿠폰이름</strong>
                                  <span class="tooltip-time">만료 3일전</span>
                                </div>
                                <div>
                                  <div>
                                    <strong>15%</strong>
                                  </div>
                                  <div class="tooltip-min">
                                    최소 금액 : 20,000
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="ticket-used-amount">
                          <div class="price-box">
                            <span>사용금액</span>
                            <span>-25000</span>
                          </div>
                          <div class="coupon-icon-area">
                            <div class="coupon-container">
                              <img
                                src="/image/coupon.png"
                                alt="쿠폰"
                                class="coupon-img"
                              />
                              <div class="tooltip">
                                <div>
                                  <strong>000샵 정액권</strong>
                                  <div>100,000</div>
                                </div>
                                <div>
                                  <strong>현재 잔액</strong>
                                  <div>70,000</div>
                                </div>
                                <div>
                                  <strong>결제 예정액</strong>
                                  <div>-25,000</div>
                                </div>

                                <div></div>

                                <div>
                                  <strong>예정 잔액</strong>
                                  <div>45,000</div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="final-price">
                          <div class="price-box">
                            <span>지불 예정액</span>
                            <span>0</span>
                          </div>
                          <div class="coupon-icon-area">
                            <img src="/image/coupon.png" alt="쿠폰" />
                          </div>
                        </div>
                      </div>

                      <div class="shop-info-details">
                        <div class="address-box">
                          <div class="address-title">주소</div>
                          <div class="address">
                            대전 광역시 대덕구 어쩌구저쩌구
                          </div>
                        </div>

                        <div class="tel-box">
                          <div class="tel-title">전화번호</div>
                          <div class="tel">010-5482-5482</div>
                        </div>
                      </div>
                      <div class="btn-box">
                        <button class="reservation-change" href="">
                          변경하기
                        </button>
                        <button class="re-reservation" href="">
                          재예약하기
                        </button>
                        <button
                          class="review-create"
                          onclick="openCreateReviewModal()"
                        >
                          리뷰쓰기
                        </button>
                        <button class="review-show" href="">리뷰 보기</button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="no-reserviation" style="display: none">
                  예약 내역이 없습니다. 헤어샵에 예약을 해보세요!
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 리뷰 작성 모달 -->

        <div id="createReviewModal" class="modal">
          <div class="modal-container">
            <div class="modal-header">
              <div></div>
              <h2>리뷰 작성하기</h2>
              <span class="close" onclick="closeCreateReviewModal()"
                >&times;</span
              >
            </div>

            <div class="modal-main">
              <form
                action="/createReview"
                onsubmit="return false;"
                enctype="multipart/form-data"
              >
                <div class="star-rating">
                  <span class="star" data-value="1">★</span>
                  <span class="star" data-value="2">★</span>
                  <span class="star" data-value="3">★</span>
                  <span class="star" data-value="4">★</span>
                  <span class="star" data-value="5">★</span>
                </div>
                <input
                  type="hidden"
                  name="rating"
                  id="ratingInput"
                  value="0"
                  required
                />

                <div class="review-input-box">
                  <textarea
                    id="reviewText"
                    class="review-textarea"
                    rows="5"
                    required
                  ></textarea>
                </div>

                <div class="image-upload-box">
                  <label for="reviewImages">이미지 첨부</label>
                  <input
                    type="file"
                    id="reviewImages"
                    name="reviewImages"
                    accept="image/*"
                    multiple
                  />
                  <div id="previewContainer" class="preview-container"></div>
                </div>
              </form>
            </div>
          </div>
        </div>

        <script>
          document.addEventListener("DOMContentLoaded", function () {
            const boxes = document.querySelectorAll(".my-reservation-box");

            boxes.forEach((box) => {
              box.addEventListener("click", function () {
                const details = box.querySelector(".my-reservation-details");

                if (!details) return;

                // 이미 열려 있으면 닫기
                if (details.style.display === "block") {
                  details.style.display = "none";
                } else {
                  // 다른 박스들은 닫기 (선택)
                  document
                    .querySelectorAll(".my-reservation-details")
                    .forEach((d) => {
                      d.style.display = "none";
                    });
                  // 현재 박스 열기
                  details.style.display = "block";
                }
              });
            });

            const stars = document.querySelectorAll(".star-rating .star");
            const ratingInput = document.getElementById("ratingInput");

            stars.forEach((star, index) => {
              star.addEventListener("click", () => {
                const rating = star.getAttribute("data-value");
                ratingInput.value = rating;

                // 별 색상 업데이트
                stars.forEach((s, i) => {
                  s.classList.toggle("selected", i < rating);
                });
              });
            });

            //이미지 미리보기

            const imageInput = document.getElementById("reviewImages");
            const previewContainer =
              document.getElementById("previewContainer");
            let uploadedFiles = [];

            imageInput.addEventListener("change", function () {
              const files = Array.from(this.files);

              files.forEach((file) => {
                if (!file.type.startsWith("image/")) return;
                if (uploadedFiles.length >= 10) return;
                uploadedFiles.push(file);
              });

              renderPreviews();
              syncInputFiles();
            });

            function renderPreviews() {
              previewContainer.innerHTML = "";

              uploadedFiles.forEach((file, index) => {
                const reader = new FileReader();

                reader.onload = function (e) {
                  const previewDiv = document.createElement("div");
                  previewDiv.className = "image-preview";

                  const img = document.createElement("img");
                  img.src = e.target.result;

                  const removeBtn = document.createElement("button");
                  removeBtn.className = "remove-image";
                  removeBtn.textContent = "×";

                  removeBtn.addEventListener("click", () => {
                    uploadedFiles.splice(index, 1);
                    renderPreviews();
                    syncInputFiles();
                  });

                  previewDiv.appendChild(img);
                  previewDiv.appendChild(removeBtn);
                  previewContainer.appendChild(previewDiv);
                };

                reader.readAsDataURL(file);
              });
            }

            function syncInputFiles() {
              const dataTransfer = new DataTransfer();
              uploadedFiles.forEach((file) => dataTransfer.items.add(file));
              imageInput.files = dataTransfer.files;
            }
          });

          // 모달열고 닫기

          function openCreateReviewModal() {
            document.getElementById("createReviewModal").style.display =
              "block";
          }

          function closeCreateReviewModal() {
            document.getElementById("createReviewModal").style.display = "none";
          }
        </script>
      </body>
    </html>
  </body>
</html>
